<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="favicon.ico" type="image/x-icon"/>
  <link rel="stylesheet" type="text/css" href="../abcjs-audio.css">
  <link rel="stylesheet" href="examples-styles.css"/>

  <title>Output Transposition</title>
  <script src="../dist/abcjs-basic.js" type="text/javascript"></script>
  <script type="text/javascript">
    var editor;
    var renderParams = { selectTypes: false};
    var outputEl;
    var abcEl;
    var currentAbc = ""
    window.onload = function() {
      abcEl = document.querySelector("#abc");
      outputEl = document.querySelector("#transposed");
      visualTransposeEl = document.querySelector(".transpose");

      editor = new ABCJS.Editor("abc", { canvas_id: "paper",
        warnings_id: "warnings",
        abcjsParams: renderParams,
      });

      visualTransposeEl.addEventListener("change", paramChanged);
      paramChanged();
    };

    function paramChanged() {
      var visualObj = editor.tunes
      var abc = abcEl.value
      var steps = visualTransposeEl.value
      var output = ABCJS.strTranspose(abc, visualObj, steps)
      outputEl.innerText = output
      ABCJS.renderAbc("paper2", output)
    }
  </script>
  <style>
  </style>
</head>
<body>
  <header>
    <img src="https://paulrosen.github.io/abcjs/img/abcjs_comp_extended_08.svg" alt="abcjs logo">
    <h1>Output Transposition</h1>
  </header>
  <div class="container">
    <main>
      <p>This demonstrates transposing an ABC string and retrieving that transposed string.</p>
      <section class="input">
        <h2>ABC String</h2>
          <textarea aria-label="ABC string" id="abc" spellcheck="false">
X: 1
T: Cooley's
M: 4/4
L: 1/8
R: reel
K: Em
V: Melody
|:D2|EB{c}BA B2 EB|~B2 AB dBAG|FDAD BDAD|FDAD dAFD|
EBBA B2 EB|B2 AB defg|afe^c dBAF|DEFD E2:|
|:gf|eB B2 efge|eB B2 gedB|A2 FA DAFA|A2 FA defg|
eB B2 eBgB|eB B2 defg|afe^c dBAF|DEFD E2:|
    </textarea>
        <fieldset>
          <legend>Options</legend>
          <label>Transpose:
            <input
                class="transpose"
                type="number"
                min="-24"
                max="24"
                step="1"
                value="0">
          </label>
        </fieldset>
      </section>

      <section class="output">
        <h2>Output</h2>
        <pre id="transposed"></pre>
        <h3>Transposed Output</h3>
        <div id="paper2" class="visible-background"></div>
        <h3>Original Output</h3>
        <div id="warnings"></div>
        <div id="paper" class="visible-background"></div>
      </section>
    </main>
  </div>
</body>
</html>
